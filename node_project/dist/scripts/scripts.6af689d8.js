"use strict";angular.module("stockApp",["ngCookies","ngResource","ngRoute","ngTouch","ui.bootstrap","ngLoadingSpinner"]).config(["$routeProvider",function(a){a.when("/company",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/watchlist",{templateUrl:"views/watchlist.html",controller:"WatchlistCtrl",controllerAs:"watchlist"}).when("/portfolio",{templateUrl:"views/portfolio.html",controller:"PortfolioCtrl",controllerAs:"portfolio"}).when("/login",{templateUrl:"views/login.html",controller:"LoginCtrl",controllerAs:"login"}).otherwise({redirectTo:"/company"})}]),angular.module("stockApp").controller("MainCtrl",["$scope","$http","$q","$timeout","CommonFactory",function(a,b,c,d,e){function f(){j.days=[],j.price=[],j.volume=[],j.revenue=[],j.profit=[];var c=!1;switch(a.duration.radioModel){case 1:c="";break;case 7:c="5D";break;case 15:case 30:c="1M";break;case 90:c="3M";break;case 180:c="6M";break;case 365:c="12M";break;case 1095:c="36M";break;case 1825:c="60M"}c=c?"&flag="+c:"",b({method:"get",url:"http://www.bseindia.com/BSEGraph/Graphs/GetStockReachVolPriceData.aspx?index="+a.stock.id+c}).then(function(c){var d=c.data.split("#");d.splice(0,2);var f=[];_.each(d,function(a){a&&f.push(a)}),_.each(f,function(b,c){if(a.duration.radioModel<=7){var d=b.split(",")[0].split(" ");d[0]=d[0].split("/").reverse().join("-"),j.days.push(d.join(" "))}else j.days.push(b.split(",")[0].split(" ")[0].split("/").reverse().join("-"));j.price.push(Number(b.split(",")[2])),j.volume.push(Number(b.split(",")[3])/1e3),j.price[c]>j.price[c-1]||0===c?j.volume[c]={y:j.volume[c],color:"#44B544"}:j.volume[c]={y:j.volume[c]},j.profit.push(null),j.revenue.push(null)}),a.duration.radioModel>=365?b({method:"get",url:"https://www.screener.in/api/company/"+a.stock.symbol}).then(function(a){if(a.data)for(var b in a.data.number_set.quarters[0][1])for(var c=-1,d=b,f=String(d).split("-"),g=f[1],h=f[2],i=f[0],k=null,l=0;l<7;l++)if(k=h-l+"-"+g+"-"+i,-1!==(c=_.indexOf(j.days,k))){j.profit[c]=Number(a.data.number_set.quarters[9][1][b]),j.revenue[c]=Number(a.data.number_set.quarters[0][1][b]);break}e.renderChart(j)}):e.renderChart(j)})}function g(a){var b=moment().subtract(a,"days").format("L").split("/"),c=b.shift();return b.splice(1,0,c),b.join("-"),b}function h(a){return _.meanBy(a,function(a){return a.y}).toFixed(2)}function i(){if(!isNaN(Number(a.stock.symbol)))return e.toggleMessageVisibility("stock not listed in nse !!",!1),a.stock.id=a.stock.symbol,void f();j.days=[],j.price=[],j.volume=[],j.revenue=[],j.profit=[],1===a.duration.radioModel&&(delete j.volume,delete j.revenue,delete j.profit,b({method:"get",url:"/apiData?CDSymbol="+a.stock.symbol+"&Segment=CM&Series=EQ&CDExpiryMonth=&FOExpiryMonth=&IRFExpiryMonth=&CDDate1=&CDDate2=&PeriodType=2&Periodicity=1&Template=tame_intraday_getQuote_closing_redgreen.jsp"}).then(function(a){console.log(a);var b=null;a.data&&$(a.data).find("csv")&&$(a.data).find("csv").find("data")[0]&&(b=$($(a.data).find("csv").find("data")[0]).text().split(" "),_.each(b,function(a,b){b&&(a=_.compact(a.split(",")),j.days.push(a[0].split(":").splice(0,2).join(":")),j.price.push(Math.round(10*a[1])/10))}),e.renderChart(j))},function(a){console.log("Error!!")})),j.days=[],j.price=[],j.volume=[],j.revenue=[],j.profit=[];var c=a.stock.symbol;-1!=c.indexOf("&")&&(c=c.replace("&","%26"));var d=a.duration.radioModel>1095?a.duration.radioModel:1095,i=g(d+1),k=g(0);b({method:"get",cache:!0,url:"/getStockData?symbol="+c+"&series=EQ&fromDate="+i+"&toDate="+k}).then(function(d){var f=$(d.data),g=_.compact($(f[4]).find("tr")),i=Math.round(.7*a.duration.radioModel);g.splice(0,1);g=g.slice(0,i).reverse(),angular.forEach(g,function(a,b){var c=$(a).find("td");j.days.push(c[0].innerHTML),j.price.push(Number(c[7].innerHTML.replace(/,/g,""))),j.volume.push(Number(c[8].innerHTML.replace(/,/g,""))/1e3),j.price[b]>j.price[b-1]||0===b?j.volume[b]={y:j.volume[b],color:"#44B544"}:j.volume[b]={y:j.volume[b]},j.profit.push(null),j.revenue.push(null)}),b({method:"get",url:"/getStockDataNSE?symbol="+c+"&illiquid=0&smeFlag=0&itpFlag=0"}).then(function(d){var f=null,g=null,i=0;i=h(j.volume.slice(j.volume.length>22?j.volume.length-22:0,j.volume.length)),(g=$(d.data).find("#responseDiv"))&&g.length&&JSON.parse(g.text()).data&&(f=JSON.parse(g.text()).data[0],f.secDate&&f.secDate.slice(0,2)!=moment().date()&&(j.days.push(moment().date()),j.price.push(Number(f.lastPrice.replace(/,/g,""))),j.price[j.price.length-1]>j.price[j.price.length-2]?j.volume.push({y:Number(f.totalTradedVolume.replace(/,/g,""))/1e3,color:"#44B544"}):j.volume.push({y:Number(f.totalTradedVolume.replace(/,/g,""))/1e3}),j.profit.push(null),j.revenue.push(null)),j.days.length>2&&(a.latestPriceVolumeData={price:j.price[j.price.length-1],relativePrice:Math.round((j.price[j.price.length-1]-j.price[j.price.length-2])/j.price[j.price.length-2]*1e4)/100,volume:j.volume[j.volume.length-1].y,averageVolume:i,relativeVolume:Math.round(j.volume[j.volume.length-1].y/i*100)/100}),a.duration.radioModel>1&&b({method:"get",url:"https://www.screener.in/company/"+c}).then(function(a){console.log(a.data);const b=$(a.data).find("#quarters"),c=b.find("tr")[0].querySelectorAll("th"),d=b.find("tr")[1].querySelectorAll("td"),f=b.find("tr")[10].querySelectorAll("td");var g=-1;if(c&&c.length)for(var h=1;h<c.length;h++){var i=c[h].innerText,k=String(i).split(" "),l=k[0],m=30,n=k[1],o=n+"/"+l+"/"+m;l=moment(o).format("ll").split(" ")[0],o=m+"-"+l+"-"+n;for(var p=0;p<7;p++)if(o=m-p+"-"+l+"-"+n,-1!==(g=_.indexOf(j.days,o))){j.profit[g]=Number(f[h].innerText.trim().replace(/,/g,"")),j.revenue[g]=Number(d[h].innerText.trim().replace(/,/g,""));break}}e.renderChart(j)}),e.renderChart(j))})},function(a){e.toggleMessageVisibility("Something went wrong. Please try after some time !!",!1)})}var j={days:[],price:[],volume:[]};a.$root.view="home",a.$root.stock||sessionStorage.getItem("selectedStock")?(a.stock=a.$root.stock||JSON.parse(sessionStorage.getItem("selectedStock")),sessionStorage.setItem("selectedStock",JSON.stringify(a.stock))):(a.stock={name:"Rajesh Exports",symbol:"RAJESHEXPO"},a.$root.stock=a.stock),a.latestPriceVolumeData=null,a.search={stock:[],selectedStock:null},a.duration={},sessionStorage.duration?a.duration.radioModel=Number(sessionStorage.getItem("duration")):a.duration.radioModel=365,a.updateSearch=function(){b.get("/getSearchResult?q="+a.search.selectedStock).then(function(b){a.search.stock=b.data})},a.onTypeaheadSelection=function(){a.showStockDetails()},a.durationChanged=function(){sessionStorage.setItem("duration",a.duration.radioModel),i()},a.addToWatchlist=function(){var c={name:a.stock.name,priority:"4",symbol:a.stock.symbol};b({method:"post",url:"/addStock",data:{stock:c}}).then(function(a){a&&a.data&&e.toggleMessageVisibility(a.data.message,a.data.saved)},function(a){e.toggleMessageVisibility("An error occured. Stock not added to watchlist !!",!1)})},a.showNote=function(){a.showNotes=!0,b({method:"get",url:"/getWatchlist"}).then(function(b){if(b.data&&b.data.length){var c=_.find(b.data,{symbol:a.stock.symbol});c?(delete c._id,a.stock=c):a.stock.note=null}})},a.saveNote=function(c){a.showNotes=!1,b({method:"post",url:"/editStock",data:{stock:a.stock}}).then(function(a){a&&a.data&&e.toggleMessageVisibility(a.data.message,a.data.saved)},function(a){e.toggleMessageVisibility("An error occured. View updated to previouly saved watchlist !!",!1)})},a.showStockDetails=function(){if(a.search.selectedStock){var b=_.find(a.search.stock,{name:a.search.selectedStock});a.search.selectedStock=null,a.stock={},b&&(a.stock.name=b.name,a.stock.id=b.id,a.stock.symbol=b.url.split("/")[2],a.$root.stock=a.stock,sessionStorage.setItem("selectedStock",JSON.stringify(a.stock)),i())}},a.openNewsPopup=function(){e.getNewsData(a.stock)},a.updateNseValue=function(){e.updateNseValue()},a.updateNseValue(),i()}]),angular.module("stockApp").controller("WatchlistCtrl",["$scope","$http","$timeout","$location","CommonFactory",function(a,b,c,d,e){function f(){b({method:"get",url:"http://localhost:4000/getWatchlist"}).then(function(c){a.editPageData.watchlist2=[],c.data&&c.data.length&&(a.editPageData.watchlist2=c.data),a.editPageData.watchlistCopy=angular.copy(a.editPageData.watchlist),_.each(a.editPageData.watchlist2,function(a){var c={days:[],price:[],volume:[]},d=null,f=null;if(isNaN(Number(a.symbol))){b({method:"get",url:"https://www1.nseindia.com/live_market/dynaContent/live_watch/get_quote/GetQuote.jsp?symbol="+a.symbol+"&illiquid=0&smeFlag=0&itpFlag=0"}).then(function(h){d=$(h.data).find("#responseDiv"),b({method:"get",url:"http://www.nseindia.com/live_market/dynaContent/live_watch/get_quote/getHistoricalData.jsp?symbol="+a.symbol+"&series=EQ&fromDate="+i+"&toDate="+j}).then(function(b){var e=$(b.data),h=$(e[4]).find("tr");h.splice(0,1);angular.forEach(_.reverse(h),function(a,b){var d=$(a).find("td");c.days.push(d[0].innerHTML),c.price.push(Number(d[7].innerHTML.replace(/,/g,""))),c.volume.push(Number(d[8].innerHTML.replace(/,/g,""))/1e3)}),c.averageVolume=Math.round(100*_.mean(c.volume))/100,d&&d.length&&(f=JSON.parse(d.text()).data[0])&&f.secDate&&f.secDate.slice(0,2)!=moment().date()&&(c.price.push(f.lastPrice.replace(/,/g,"")),c.volume.push(f.totalTradedVolume.replace(/,/g,"")/1e3)),a.volumeCriteriaOld=Number((c.volume[c.volume.length-1]+c.volume[c.volume.length-2])/(2*c.averageVolume)).toFixed(2),a.price=c.price[c.price.length-1],a.volume=c.volume[c.volume.length-1],a.changeInVolume=c.averageVolume?Math.round(c.volume[c.volume.length-1]/c.averageVolume*100)/100:"NA",a.changeInPrice=c.price[c.price.length-2]?Math.round((c.price[c.price.length-1]-c.price[c.price.length-2])/c.price[c.price.length-2]*1e4)/100:"NA",g.push(c)},function(a){e.toggleMessageVisibility("Something went wrong. Please try after some time !!",!1)})});var h=30,i=e.formatDate(h+1),j=e.formatDate(0)}else b({method:"get",url:"http://www.bseindia.com/BSEGraph/Graphs/GetStockReachVolPriceData.aspx?index="+a.symbol+"&flag=5D"}).then(function(b){var d=b.data.split("#");d.splice(0,2);var e=[];_.each(d,function(a,b){a&&e.push(a)});var f=0;_.each(e,function(a,b){0==b?f=Number(a.split(",")[3])/1e3:e[b-1].split(" ")[0]==e[b].split(" ")[0]?(f+=a.split(",")[3]?Number(a.split(",")[3])/1e3:0,b===e.length-1&&(c.days.push(e[b-1].split(",")[0].split(" ")[0].split("/").reverse().join("-")),c.price.push(Number(e[b-1].split(",")[2])),c.volume.push(Number(Number(f).toFixed(3))),f=0)):(c.days.push(e[b-1].split(",")[0].split(" ")[0].split("/").reverse().join("-")),c.price.push(Number(e[b-1].split(",")[2])),c.volume.push(Number(Number(f).toFixed(3))),f=Number(a.split(",")[3])/1e3)}),c.volume.pop(),c.averageVolume=Math.round(100*_.mean(c.volume))/100,a.volumeCriteriaOld=Number((c.volume[c.volume.length-1]+c.volume[c.volume.length-2])/(2*c.averageVolume)).toFixed(2),a.price=c.price[c.price.length-1],a.volume=c.volume[c.volume.length-1],a.changeInVolume=c.averageVolume?Math.round(c.volume[c.volume.length-1]/c.averageVolume*100)/100:"NA",a.changeInPrice=c.price[c.price.length-2]?Math.round((c.price[c.price.length-1]-c.price[c.price.length-2])/c.price[c.price.length-2]*1e4)/100:"NA",g.push(c)})})},function(a){e.toggleMessageVisibility(a.data.message,!1)})}var g=[];a.$root.view="watchlist",a.search={stock:[],selectedStock:null},a.editPageData={predicate:"priority",reverse:!1,currentStock:null,watchlist2:[],watchlistCopy:null},a.redirectToDetailsPage=function(b){a.$root.stock=b,d.path("/#")},a.saveStockData=function(c){delete c._id,delete c.price,delete c.changeInPrice,delete c.volume,b({method:"post",url:"add"===a.mode?"http://localhost:4000/addStock":"http://localhost:4000/editStock",data:{stock:c}}).then(function(b){b&&b.data&&(e.toggleMessageVisibility("Data saved successfully",!0),"add"===a.mode&&f())},function(b){a.editPageData.watchlist2=a.editPageData.watchlistCopy,e.toggleMessageVisibility("An error occured. View updated to previouly saved watchlist !!",!1)}),a.mode=null,a.search.selectedStock=null,a.editPageData.currentStock=null},a.onTypeaheadSelection=function(){if(a.search.selectedStock){var b=_.find(a.search.stock,{name:a.search.selectedStock});b&&(a.editPageData.currentStock.name=b.name,a.editPageData.currentStock.id=b.id,a.editPageData.currentStock.symbol=b.url.split("/")[2])}},a.updateSearch=function(){b.get("https://www.screener.in/api/company/search/?q="+a.search.selectedStock).then(function(b){a.search.stock=b.data})},a.addStock=function(){a.mode="add",a.editPageData.currentStock={},$("#addStockSpan").click()},a.editStock=function(b){a.mode="edit",a.editPageData.currentStock=angular.copy(b)},a.deleteStock=function(c){a.editPageData.currentStock=c,b({method:"post",url:"http://localhost:4000/deleteStock",data:{stock:a.editPageData.currentStock}}).then(function(b){a.editPageData.currentStock=null,b&&b.data&&b.data.saved&&(a.editPageData.watchlist2=_.reject(a.editPageData.watchlist2,{symbol:c.symbol}),e.toggleMessageVisibility("Data removed successfully",!0))},function(b){a.editPageData.currentStock=null,e.toggleMessageVisibility("An error occured. View updated to previouly saved watchlist !!",!1)})},a.orderBy=function(b){a.editPageData.reverse=a.editPageData.predicate===b&&!a.editPageData.reverse,a.editPageData.predicate=b},a.updateNseValue=function(){e.updateNseValue()},a.openNewsPopup=function(a){e.getNewsData(a)},a.updateNseValue(),f()}]),angular.module("stockApp").controller("LoginCtrl",["$scope","$http",function(a,b){console.log("login initialized !"),console.log(a.india),a.loginFormData={userId:null,password:null,csrf:null},b({method:"get",url:"http://localhost:4000/getCsrfToken"}).then(function(b){console.log(b.data),a.loginFormData.csrf=b.data.csrf},function(a){console.log(a)}),a.submitLoginForm=function(){console.log(a.loginFormData),b({method:"post",url:"http://localhost:4000/authenticateUser",data:a.loginFormData}).then(function(b){console.log(b.data),a.userDetails=b.data},function(b){console.log(b),a.errorMessage=b.data.errorMessage})}}]),angular.module("stockApp").factory("CommonFactory",["$rootScope","$http","$timeout",function(a,b,c){function d(a){var b=moment().subtract(a,"days").format("L").split("/"),c=b.shift();return b.splice(1,0,c),b.join("-"),b}function e(){}function f(b,d){l&&c.cancel(l),a.rootScopeData.messageString=b,a.rootScopeData.messageStatus=d,l=c(function(){a.rootScopeData.messageString=null},4e3)}function g(a){for(var b={profit:0,revenue:0},c=(chartData.profit.length,0),d=a-1;d>=0;d--)if(chartData.profit[d]&&4==++c){b.profit=chartData.profit[d],b.revenue=chartData.revenue[d];break}return b}function h(a){for(var b=a-1;b>=0&&!chartData.actualPrice[b];b--);return b}function i(a){window.chartData=a;for(var b=chartData.profit.length-1;b>0;b--)if(chartData.price[b-1]/chartData.price[b]>1.3)for(var c=Math.round(100*chartData.price[b-1]/chartData.price[b])/100,d=b-1;d>=0;d--)chartData.price[d]=chartData.price[d]/c;var e=Math.round(_.sum(chartData.price.slice(0,350))/350);chartData.actualPrice=[],chartData.actualPriceUpper=[],chartData.actualPrice.length=chartData.price.length,chartData.actualPriceUpper.length=chartData.price.length,chartData.price.length>400&&(_.each(chartData.price,function(a,b){if(300===b)chartData.actualPrice[b]=e;else if(b>300&&null!==chartData.profit[b]){var c=h(b);if(chartData.profit[b]>0){var d=g(b),f={profit:chartData.profit[b],revenue:chartData.revenue[b]},i=Number(((f.profit-d.profit)/Math.abs(d.profit)).toFixed(2)),j=Number(((f.revenue-d.revenue)/Math.abs(d.revenue)).toFixed(2));i+j<=.42?chartData.actualPrice[b+50]=i+j<=0?i>=.05?Number((chartData.actualPrice[c]*(1+.03*i)).toFixed(2)):i<.05&&i>-.1?Number(chartData.actualPrice[c].toFixed(2)):Number((chartData.actualPrice[c]*(1+.33*(i+j))).toFixed(2)):Number((chartData.actualPrice[c]*(1+.33*(i+j))).toFixed(2)):i+j>.42&&i+j<=.84?Math.abs(i)>Math.abs(.66*(i+j))?chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.18*(i+j))).toFixed(2)):chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.25*(i+j))).toFixed(2)):i+j>.84&&i+j<=1.68?Math.abs(i)>Math.abs(.66*(i+j))?chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.15*(i+j))).toFixed(2)):chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.2*(i+j))).toFixed(2)):Math.abs(i)>Math.abs(.66*(i+j))?chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.12*(i+j))).toFixed(2)):chartData.actualPrice[b+50]=Number((chartData.actualPrice[c]*(1+.15*(i+j))).toFixed(2))}else chartData.actualPrice[b+50]=Number((.75*chartData.actualPrice[c]).toFixed(2))}chartData.actualPrice[b]?chartData.actualPriceUpper[b]=Math.round(1.3*chartData.actualPrice[b]*100)/100:chartData.actualPriceUpper[b]=null}),_.each(chartData.actualPrice,function(a,b){chartData.actualPrice[b]||(chartData.actualPrice[b]=null)})),chartData.movingAverage=[];var f=33;_.each(chartData.price,function(a,b){b<f?chartData.movingAverage.push(null):chartData.movingAverage.push(Math.round(_.sum(chartData.price.slice(b-f,b))/f))}),console.log(chartData),$(function(){$("#chart-container").highcharts({chart:{zoomType:"xy"},title:{text:"Stocks price - volume - earnings graph"},subtitle:{text:"Source: NA"},xAxis:[{categories:chartData.days,crosshair:!0}],yAxis:[{crosshair:!0,labels:{format:"Rs {value}",style:{color:Highcharts.getOptions().colors[0]}},title:{text:"Price",style:{color:Highcharts.getOptions().colors[0]}},max:_.max(chartData.price)>_.max(chartData.actualPrice)?_.max(chartData.price):_.max(chartData.actualPrice),min:_.min(chartData.price)>_.min(chartData.actualPrice)?_.min(chartData.actualPrice):_.min(chartData.price)},{labels:{format:"{value} Cr",style:{color:Highcharts.getOptions().colors[1]}},title:{text:"revenue",style:{color:Highcharts.getOptions().colors[1]}}},{title:{text:"Volume (thousand)",style:{color:Highcharts.getOptions().colors[1]}},labels:{style:{color:Highcharts.getOptions().colors[1]}},opposite:!0},{gridLineWidth:0,title:{text:"Profit",style:{color:Highcharts.getOptions().colors[1]}},labels:{format:"{value} Cr",style:{color:Highcharts.getOptions().colors[1]}},opposite:!0}],tooltip:{shared:!0,positioner:function(){return{x:800,y:0}},shadow:!1,borderWidth:0},legend:{},series:[{name:"Volume",type:"column",yAxis:2,data:chartData.volume,tooltip:{valueSuffix:" ths"},color:Highcharts.getOptions().colors[3]},{name:"revenue",type:"column",connectNulls:!0,yAxis:1,data:chartData.revenue||[],dashStyle:"shortdot",tooltip:{valueSuffix:" Cr"},color:Highcharts.getOptions().colors[1]},{name:"profit",type:"spline",connectNulls:!0,yAxis:3,data:chartData.profit||[],dashStyle:"shortdot",tooltip:{valueSuffix:" Cr"},color:Highcharts.getOptions().colors[2]},{name:"Actual Price",type:"spline",yAxis:0,data:chartData.actualPrice,connectNulls:!0,tooltip:{valueSuffix:""},color:Highcharts.getOptions().colors[4],fillColor:{linearGradient:[0,0,0,200],stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}},{name:"Actual Price U",type:"spline",yAxis:0,data:chartData.actualPriceUpper,connectNulls:!0,dashStyle:"shortdot",tooltip:{valueSuffix:""},color:Highcharts.getOptions().colors[5],fillColor:{linearGradient:[0,0,0,200],stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}},{name:"moving Price",type:"spline",yAxis:0,data:chartData.movingAverage,connectNulls:!0,dashStyle:"shortdot",tooltip:{valueSuffix:""},color:Highcharts.getOptions().colors[6],fillColor:{linearGradient:[0,0,0,200],stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}},{name:"price",type:"area",yAxis:0,data:chartData.price,tooltip:{valueSuffix:""},color:Highcharts.getOptions().colors[0],fillColor:{linearGradient:[0,0,0,200],stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]}}]})})}function j(a){var c=[];$("#myModalLabel").text(a.name),b.get("http://www.bseindia.com/SiteCache/1D/GetQuoteData.aspx?Type=EQ&text="+a.symbol).then(function(a){c=$(a.data),c=c.find("li a").attr("href").split("/"),c=c[c.length-2],b({method:"get",url:"http://www.bseindia.com/stock-share-price/Notification.aspx?scripcode="+c}).then(function(a){if(a&&a.data){var b=$(a.data).find("#divNotification");b=$(b.find("tr")),b.splice(0,2),$("#notification").html(b)}},function(){k.toggleMessageVisibility("An error occured while fetching news. !!",!1)}),b({method:"get",url:"http://www.bseindia.com/stock-share-price/SiteCache/TabResult.aspx?text="+c+"&type=news"}).then(function(a){if(a&&a.data){var b=$(a.data).find("table");b=$(b.find("tr")),$("#news").html(b)}},function(){k.toggleMessageVisibility("An error occured while fetching news. !!",!1)})})}var k=null;a.rootScopeData={valueNse:null,changeNse:null,pChangeNse:null,messageString:null,messageStatus:null};var l=null;return k={formatDate:d,updateNseValue:e,toggleMessageVisibility:f,renderChart:i,getNewsData:j}}]),angular.module("stockApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/edit.html",'<p>This is edit page.</p> <div class=""> <table class="table"> <tr> <th>Quarter</th> <th>Date</th> <th>Revenue</th> <th>Profit</th> </tr> <tr ng-repeat="item in stockProfile"> <td class="col-sm-3"> \x3c!-- dropdown for quater selection --\x3e <select class="form-control" ng-model="item.quarter"> <option value="-1">--Quarter--</option> <option value="Q1">Q1</option> <option value="Q2">Q2</option> <option value="Q3">Q3</option> <option value="Q4">Q4</option> </select> </td> <td class="col-sm-3"> \x3c!-- datepicker for result declaration date selection --\x3e <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="item.date" is-open="item.opened" datepicker-options="dateOptions" ng-required="true" close-text="Close" alt-input-formats="altInputFormats"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="item.opened = !item.opened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </td> <td class="col-sm-2"> <input class="form-control" type="text" ng-model="item.revenue"> </td> <td class="col-sm-2"> <input class="form-control" type="text" ng-model="item.profit"> </td> <td class="col-sm-1"> <input class="btn btn-primary" type="button" value="Add Row (+)" ng-click="alterRecord(\'add\', $index)"> </td> <td class="col-sm-1"> <input class="btn btn-primary" type="button" value="Remove Row (-)" ng-click="alterRecord(\'remove\', $index)"> </td> </tr> </table> <input class="btn btn-primary" ng-hide="stockProfile.length" type="button" value="Add Row (+)" ng-click="alterRecord(\'add\', 0)"> <input class="btn" type="button" value="Cancel" ng-click="saveRecord(\'cancel\')"> <input class="btn btn-primary" type="button" value="Save Changes" ng-click="saveRecord(\'save\')"> </div> \x3c!-- savedStockProfile: {{savedStockProfile}} --\x3e <br><br> \x3c!-- stockProfile: {{stockProfile}} --\x3e'),a.put("views/login.html",'<div id="login-container"> <div class="login-overlay"> <div class="form-container"> <h2>{{errorMessage}}</h2> <form novalidate ng-submit="submitLoginForm()"> <input type="text" name="userId" placeholder="User ID" ng-model="loginFormData.userId" required> <input type="password" name="password" placeholder="Password" ng-model="loginFormData.password" required> <button>Submit</button> <input type="hidden" name="csrf" ng-model="csrf"> </form> </div> </div> </div>'),a.put("views/main.html",'<div id="container"> <input type="button" value="Search" class="btn" ng-class="{\'btn-primary\': search.selectedStock}" style="float:right; margin-left: 5px" ng-click="showStockDetails()"> <div style="float: right"> <input type="text" ng-change="updateSearch()" ng-model="search.selectedStock" placeholder="search stock" uib-typeahead="stock.name for stock in search.stock | filter:$viewValue | limitTo:5" typeahead-on-select="onTypeaheadSelection()" class="form-control"> </div> <input type="button" value="Add to Watchlist" class="btn" ng-class="" style="float:right; margin-left: 5px" ng-click="addToWatchlist()"> <h1> <span style="font-size: 18px"> {{stock.name}} ({{stock.symbol}}) </span> <a class="btn btn-lg" ng-click="openNewsPopup()" data-toggle="modal" data-target="#newsModal"> News </a> </h1> <div class="duration-container"> <div class="btn-group"> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="1">1 Day</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="7">1 Week</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="15">2 Week</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="30">1 Month</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="90">3 Month</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="180">6 Month</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="365">1 Year</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="1095">3 Year</label> <label class="btn btn-primary" ng-model="duration.radioModel" ng-change="durationChanged()" uib-btn-radio="1825">5 Year</label> </div> </div> <div id="chart-container"> <span ng-show="!chartData.days.length">No Data Available</span> </div> <div ng-show="latestPriceVolumeData"> <ul> <li>Price: {{latestPriceVolumeData.price}} ( <span class="bold" ng-class="{positivePriceChange: latestPriceVolumeData.relativePrice > 0, negativePriceChange: latestPriceVolumeData.relativePrice < 0}"> {{latestPriceVolumeData.relativePrice}}% </span>) </li> <li>Volume: {{latestPriceVolumeData.volume}} ( <span class="bold" ng-class="{positivePriceChange: latestPriceVolumeData.relativeVolume > 1, negativePriceChange: latestPriceVolumeData.relativeVolume < 1}"> {{latestPriceVolumeData.relativeVolume}} times </span>) </li> <li>Average Volume: {{latestPriceVolumeData.averageVolume}}</li> </ul> </div> \x3c!-- <div id="tabular-data">\n\t   No Data Available\n\t   <table class="table table-striped table-bordered"></table>\n\t</div> --\x3e <div class="row notes" ng-init="showNotes=false"> <div class="col-sm-10"> <textarea class="textarea" ng-show="showNotes" ng-model="stock.note" placeholder="Add notes" rows="6">notes</textarea> </div> <div class="col-sm-2 row"> <input class="btn btn-primary col-sm-12" ng-show="!showNotes" ng-click="showNote()" type="button" value="Show Notes"> <input class="btn btn-primary col-sm-12" ng-show="showNotes" ng-click="showNotes=false" type="button" value="Hide Notes"> <input class="btn btn-primary col-sm-12" ng-show="showNotes" ng-click="saveNote()" type="button" value="Save"> <input class="btn btn-primary col-sm-12" ng-show="showNotes" ng-click="showNotes=false" type="button" value="Cancel"> </div> </div> \x3c!-- Modal --\x3e <div class="modal fade" id="newsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4> </div> <div class="modal-body"> <h3>Notification:</h3> <table class="table table-bordered" id="notification"> </table> <h3>News:</h3> <table class="table table-bordered" id="news"> </table> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Done</button> \x3c!-- <button type="button" class="btn btn-primary">Save changes</button> --\x3e </div> </div> </div> </div> </div>'),
a.put("views/portfolio.html",'<h3> Portfolio </h3> <div style="float: right; margin-top:-42px"> <input class="btn btn-primary" type="button" ng-disabled="editPageData.currentStock" value="Add New Stock (+)" ng-click="addStock()"> <input class="btn" type="button" ng-show="editPageData.currentStock" value="Cancel" ng-click="saveStockData(false)"> <input class="btn btn-primary" type="button" ng-show="editPageData.currentStock" value="Save" ng-click="saveStockData()" ng-disabled="!editPageData.currentStock.symbol"> </div> <div> \x3c!-- <div ng-show="editPageData.currentStock" style="padding: 16px 8px; border: 1px solid #ccc; margin-bottom: 20px;">\n        <div ng-show="mode==\'edit\'">\n            <h4>\n                {{editPageData.currentStock.name}}\n            </h4>\n            <table class="table">\n                <tr>\n                    <th class="col-sm-2">Priority</th>\n                    <th class="col-sm-10">Notes</th>\n                </tr>\n                <tr>\n                    <td>\n                        <select name="priority" ng-model="editPageData.currentStock.priority" class="form-control">\n                            <option value="-1">--Select--</option>\n                            <option value="1">1</option>\n                            <option value="2">2</option>\n                            <option value="3">3</option> \n                            <option value="4">4</option>\n                            <option value="5">5</option>\n                        </select>\n                    </td>\n                    <td>\n                        <input class="form-control" type="text" ng-model="editPageData.currentStock.note">\n                    </td>\n                </tr>\n            </table>\n        </div>\n        \n        <table ng-show="mode==\'add\'">\n            <tr>\n                <th class="col-sm-1">Priority</th>\n                <th class="col-sm-3">Stock Name</th>\n                <th class="col-sm-8">Notes</th>\n            </tr>\n            <tr>\n                <td>\n                    <select name="priority" ng-model="editPageData.currentStock.priority" class="form-control">\n                        <option value="-1">--Select--</option>\n                        <option value="1">1</option>\n                        <option value="2">2</option>\n                        <option value="3">3</option> \n                        <option value="4">4</option>\n                        <option value="5">5</option>\n                    </select>\n                </td>\n                <td>\n                    <input type="text" ng-change="updateSearch()" ng-model="search.selectedStock" placeholder="search stock" uib-typeahead="stock.name for stock in search.stock | filter:$viewValue | limitTo:5" typeahead-on-select="onTypeaheadSelection()" class="form-control">\n                </td>\n                <td>\n                    <input type="text" ng-model="editPageData.currentStock.note" placeholder="Note" class="form-control" style="width: 100%;">\n                </td>\n            </tr>\n        </table>\n    </div>\n\n    <table class="table table-striped watchlist">\n        <tr>\n            <th class="col-sm-1">\n                <span class="sort-handle" ng-click="orderBy(\'priority\')">Priority</span>\n                <i ng-show="editPageData.predicate==\'priority\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i>\n                <i ng-show="editPageData.predicate==\'priority\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i>\n            </th>\n            <th class="col-sm-2">\n                <span class="sort-handle" ng-click="orderBy(\'name\')">Stock Name</span>\n                <i ng-show="editPageData.predicate==\'name\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i>\n                <i ng-show="editPageData.predicate==\'name\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i>\n            </th>\n            <th class="col-sm-1 text-right">\n                <span class="sort-handle" ng-click="orderBy(\'changeInPrice\')">Price (%)</span>\n                <i ng-show="editPageData.predicate==\'changeInPrice\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i>\n                <i ng-show="editPageData.predicate==\'changeInPrice\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i>\n            </th>\n            <th class="col-sm-1 text-right">\n                <span class="sort-handle" ng-click="orderBy(\'changeInVolume\')">Volume (times)</span>\n                <i ng-show="editPageData.predicate==\'changeInVolume\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i>\n                <i ng-show="editPageData.predicate==\'changeInVolume\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i>\n            </th>\n            <th class="col-sm-1 text-right">\n                <span class="sort-handle" ng-click="orderBy(\'averageCriteria\')">Volume Criteria</span>\n                <i ng-show="editPageData.predicate==\'averageCriteria\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i>\n                <i ng-show="editPageData.predicate==\'averageCriteria\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i>\n            </th>\n            <th class="col-sm-4">Notes</th>\n            <th class="col-sm-1">Edit</th>\n            <th class="col-sm-1">Delete</th>\n        </tr>\n        <tr ng-repeat="item in editPageData.watchlist2 | orderBy:editPageData.predicate:editPageData.reverse">\n            <td>\n                <span class="bold" ng-class="{\'priority-one\': item.priority == \'1\', \'priority-two\': item.priority == \'2\', \'priority-three\': item.priority == \'3\', \'priority-four\': item.priority == \'4\', \'priority-five\': item.priority == \'5\'}">{{item.priority}}</span>\n            </td>\n            <td>\n                <span ng-click="redirectToDetailsPage(item)">{{item.name}}</span>\n                <a class="btn" ng-click="openNewsPopup(item)" data-toggle="modal" data-target="#newsModal">\n                    News\n                </a>\n            </td>\n            <td class="text-right">\n                {{item.price}} \n                <span class="bold" ng-class="{\'positivePriceChange\': item.changeInPrice > 0, \'negativePriceChange\': item.changeInPrice < 0}">\n                    ({{item.changeInPrice | number:2}})\n                </span>\n            </td>\n            <td class="text-right">\n                {{item.volume}}\n                <span class="bold" ng-class="{\'positivePriceChange\': item.changeInVolume > 1, \'negativePriceChange\': item.changeInVolume < 1}">\n                    ({{item.changeInVolume}})\n                </span>\n            </td>\n            <td class="text-right">\n                 {{item.volumeCriteriaNew}}, ({{item.volumeCriteriaOld}}), ({{item.trendCriteria}}), ({{item.averageCriteria}})\n            </td>\n            <td>\n                <div class="watchlist-note" title="{{item.note}}">\n                    {{item.note}}\n                </div>\n            </td>\n            <td>\n                <button class="btn btn-primary" ng-click="editStock(item)">\n                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>\n                    Edit\n                </button>\n            </td>\n            <td>\n                <button class="btn btn-primary" ng-click="deleteStock(item)">\n                    <i class="fa fa-times" aria-hidden="true"></i>\n                    Delete\n                </button>\n            </td>\n        </tr>\n    </table>\n\n    <div class="modal fade" id="newsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">\n      <div class="modal-dialog" role="document">\n        <div class="modal-content">\n          <div class="modal-header">\n            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>\n            <h4 class="modal-title" id="myModalLabel"></h4>\n          </div>\n          <div class="modal-body">\n            <h3>Notification:</h3>\n            <table class="table table-bordered" id="notification">\n            </table>\n\n            <h3>News:</h3>\n            <table class="table table-bordered" id="news">\n            </table>\n          </div>\n          <div class="modal-footer">\n            <button type="button" class="btn btn-default" data-dismiss="modal">Done</button>\n          </div>\n        </div>\n      </div>\n    </div> --\x3e </div>'),a.put("views/watchlist.html",'<h3> Watchlist </h3> <div style="float: right; margin-top:-42px"> <input class="btn btn-primary" type="button" value="Add New Stock (+)" ng-click="addStock()"> \x3c!-- span is used to open modal. Opening modal from above button conflicts with angular --\x3e <span id="addStockSpan" data-toggle="modal" data-target="#editModal"></span> </div> <div> \x3c!-- <div ng-show="editPageData.currentStock" style="padding: 16px 8px; border: 1px solid #ccc; margin-bottom: 20px;">\n\t\t<div ng-show="mode==\'edit\'">\n\t\t\t<h4>\n\t\t\t\t{{editPageData.currentStock.name}}\n\t\t\t</h4>\n\t\t\t<table class="table">\n\t\t\t\t<tr>\n\t\t\t\t\t<th class="col-sm-2">Priority</th>\n\t\t\t\t\t<th class="col-sm-10">Notes</th>\n\t\t\t\t</tr>\n\t\t\t\t<tr>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<select name="priority" ng-model="editPageData.currentStock.priority" class="form-control">\n\t\t\t\t\t\t\t<option value="-1">--Select--</option>\n\t\t\t\t\t\t\t<option value="1">1</option>\n\t\t\t\t\t\t\t<option value="2">2</option>\n\t\t\t\t\t\t\t<option value="3">3</option> \n\t\t\t\t\t\t\t<option value="4">4</option>\n\t\t\t\t\t\t\t<option value="5">5</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</td>\n\t\t\t\t\t<td>\n\t\t\t\t\t\t<input class="form-control" type="text" ng-model="editPageData.currentStock.note">\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</table>\n\t\t</div>\n\t\t\n\t\t<table ng-show="mode==\'add\'">\n\t\t\t<tr>\n\t\t\t\t<th class="col-sm-1">Priority</th>\n\t\t\t\t<th class="col-sm-3">Stock Name</th>\n\t\t\t\t<th class="col-sm-8">Notes</th>\n\t\t\t</tr>\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t<select name="priority" ng-model="editPageData.currentStock.priority" class="form-control">\n\t\t\t\t\t\t<option value="-1">--Select--</option>\n\t\t\t\t\t\t<option value="1">1</option>\n\t\t\t\t\t\t<option value="2">2</option>\n\t\t\t\t\t\t<option value="3">3</option> \n\t\t\t\t\t\t<option value="4">4</option>\n\t\t\t\t\t\t<option value="5">5</option>\n\t\t\t\t\t</select>\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<input type="text" ng-change="updateSearch()" ng-model="search.selectedStock" placeholder="search stock" uib-typeahead="stock.name for stock in search.stock | filter:$viewValue | limitTo:5" typeahead-on-select="onTypeaheadSelection()" class="form-control">\n\t\t\t\t</td>\n\t\t\t\t<td>\n\t\t\t\t\t<input type="text" ng-model="editPageData.currentStock.note" placeholder="Note" class="form-control" style="width: 100%;">\n\t\t\t\t</td>\n\t\t\t</tr>\n\t\t</table>\n\t</div> --\x3e <table class="table table-striped watchlist"> <tr> <th class="col-sm-1"> <span class="sort-handle" ng-click="orderBy(\'priority\')">Priority</span> <i ng-show="editPageData.predicate==\'priority\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i> <i ng-show="editPageData.predicate==\'priority\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i> </th> <th class="col-sm-2"> <span class="sort-handle" ng-click="orderBy(\'name\')">Stock Name</span> <i ng-show="editPageData.predicate==\'name\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i> <i ng-show="editPageData.predicate==\'name\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i> </th> <th class="col-sm-1 text-right"> <span class="sort-handle" ng-click="orderBy(\'changeInPrice\')">Price (%)</span> <i ng-show="editPageData.predicate==\'changeInPrice\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i> <i ng-show="editPageData.predicate==\'changeInPrice\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i> </th> <th class="col-sm-1 text-right"> <span class="sort-handle" ng-click="orderBy(\'changeInVolume\')">Volume (times)</span> <i ng-show="editPageData.predicate==\'changeInVolume\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i> <i ng-show="editPageData.predicate==\'changeInVolume\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i> </th> <th class="col-sm-1 text-right"> <span class="sort-handle" ng-click="orderBy(\'volumeCriteriaOld\')">Volume Criteria</span> <i ng-show="editPageData.predicate==\'volumeCriteriaOld\' && editPageData.reverse==true" class="fa fa-sort-asc" aria-hidden="true"></i> <i ng-show="editPageData.predicate==\'volumeCriteriaOld\' && editPageData.reverse==false" class="fa fa-sort-desc" aria-hidden="true"></i> </th> <th class="col-sm-4">Notes</th> <th class="col-sm-1">Edit</th> <th class="col-sm-1">Delete</th> </tr> <tr ng-repeat="item in editPageData.watchlist2 | orderBy:editPageData.predicate:editPageData.reverse"> <td> <span class="bold" ng-class="{\'priority-one\': item.priority == \'1\', \'priority-two\': item.priority == \'2\', \'priority-three\': item.priority == \'3\', \'priority-four\': item.priority == \'4\', \'priority-five\': item.priority == \'5\'}">{{item.priority}}</span> </td> <td> <span ng-click="redirectToDetailsPage(item)">{{item.name}}</span> \x3c!-- <span ng-click="redirectToDetailsPage(item)">{{item.name}}</span> --\x3e <a class="btn" ng-click="openNewsPopup(item)" data-toggle="modal" data-target="#newsModal"> News </a> </td> <td class="text-right"> {{item.price}} <span class="bold" ng-class="{\'positivePriceChange\': item.changeInPrice > 0, \'negativePriceChange\': item.changeInPrice < 0}"> ({{item.changeInPrice | number:2}}) </span> </td> <td class="text-right"> {{item.volume}} <span class="bold" ng-class="{\'positivePriceChange\': item.changeInVolume > 1, \'negativePriceChange\': item.changeInVolume < 1}"> ({{item.changeInVolume}}) </span> </td> <td class="text-right"> \x3c!-- {{item.volumeCriteriaNew}}, ({{item.volumeCriteriaOld}}), ({{item.trendCriteria}}), ({{item.averageCriteria}}) --\x3e {{item.volumeCriteriaOld}} </td> <td> <div class="watchlist-note" title="{{item.note}}"> {{item.note}} </div> </td> <td> \x3c!-- <a class="btn" data-toggle="modal" data-target="#newsModal"> --\x3e \x3c!-- <button class="btn btn-primary" ng-click="editStock(item)"> --\x3e <button class="btn btn-primary" ng-click="editStock(item)" data-toggle="modal" data-target="#editModal"> <i class="fa fa-pencil-square-o" aria-hidden="true"></i> Edit </button> </td> <td> <button class="btn btn-primary" ng-click="deleteStock(item)"> <i class="fa fa-times" aria-hidden="true"></i> Delete </button> </td> </tr> </table> \x3c!-- News Modal --\x3e <div class="modal fade" id="newsModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4> </div> <div class="modal-body"> <h3>Notification:</h3> <table class="table table-bordered" id="notification"> </table> <h3>News:</h3> <table class="table table-bordered" id="news"> </table> </div> <div class="modal-footer"> <button type="button" class="btn btn-default" data-dismiss="modal">Done</button> \x3c!-- <button type="button" class="btn btn-primary">Save changes</button> --\x3e </div> </div> </div> </div> \x3c!-- Edit Modal --\x3e <div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> <h4 class="modal-title" id="myModalLabel"></h4> </div> <div class="modal-body"> \x3c!-- <h3>Add / Edit:</h3> --\x3e \x3c!-- <div ng-show="editPageData.currentStock" style="padding: 16px 8px; border: 1px solid #ccc; margin-bottom: 20px;"> --\x3e <div style="padding: 16px 8px; border: 1px solid #ccc; margin-bottom: 20px"> <div ng-show="mode==\'edit\'"> <h4> {{editPageData.currentStock.name}} </h4> <table class="table"> <tr> <th class="col-sm-2">Priority</th> <th class="col-sm-10">Notes</th> </tr> <tr> <td> <select name="priority" ng-model="editPageData.currentStock.priority" class="form-control"> <option value="-1">--Select--</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> </select> </td> <td> <input class="form-control" type="text" ng-model="editPageData.currentStock.note"> </td> </tr> </table> </div> <div ng-show="mode==\'add\'"> <h4> Add Stock to watchlist </h4> <table> <tr> <th class="col-sm-1">Priority</th> <th class="col-sm-3">Stock Name</th> <th class="col-sm-8">Notes</th> </tr> <tr> <td> <select name="priority" ng-model="editPageData.currentStock.priority" class="form-control"> <option value="-1">--Select--</option> <option value="1">1</option> <option value="2">2</option> <option value="3">3</option> <option value="4">4</option> <option value="5">5</option> </select> </td> <td> <input type="text" ng-change="updateSearch()" ng-model="search.selectedStock" placeholder="search stock" uib-typeahead="stock.name for stock in search.stock | filter:$viewValue | limitTo:5" typeahead-on-select="onTypeaheadSelection()" class="form-control"> </td> <td> <input type="text" ng-model="editPageData.currentStock.note" placeholder="Note" class="form-control" style="width: 100%"> </td> </tr> </table> </div> </div> </div> <div class="modal-footer"> <input class="btn" type="button" value="Cancel" data-dismiss="modal"> <input class="btn btn-primary" type="button" value="Save" ng-click="saveStockData(editPageData.currentStock)" ng-disabled="!editPageData.currentStock.symbol" data-dismiss="modal"> \x3c!-- <button type="button" class="btn btn-default" data-dismiss="modal">Done</button> --\x3e </div> </div> </div> </div> </div>')}]);